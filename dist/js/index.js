function ready(e){"loading"!=document.readyState?e():document.addEventListener("DOMContentLoaded",e)}function add_event_listeners_to_form(){btnRefreshRepos.addEventListener("click",(()=>populate_repositories())),selectRepository.addEventListener("change",(e=>populate_branches())),tbxHeadBranch.addEventListener("input",(()=>autofill_title())),btnSubmit.addEventListener("click",(()=>submit_pr_and_comment())),populate_repositories()}ready(add_event_listeners_to_form);let loadedConfigs={};function populate_repositories(){window.zendit.send("get-settings",{repo:"globals",init:!0})}function populate_branches(){tbxSourceBranch.value="",tbxHeadBranch.value="",btnSubmit.disabled=0==selectRepository.value,"prTemplate"in loadedConfigs[selectRepository.value]?tbxPR.value=loadedConfigs[selectRepository.value].prTemplate:tbxPR.value=loadedConfigs.globals.prTemplate,"commentTemplate"in loadedConfigs[selectRepository.value]?CKEDITOR.instances.tbxJiraComment.setData(loadedConfigs[selectRepository.value].commentTemplate):CKEDITOR.instances.tbxJiraComment.setData(loadedConfigs.globals.commentTemplate),window.zendit.send("get-branches",loadedConfigs[selectRepository.value].directory)}function autofill_title(){branchList.childNodes.forEach((e=>{tbxHeadBranch.value==e.value&&(tbxPRTitle.value=tbxHeadBranch.value)}))}function submit_pr_and_comment(){window.zendit.send("create-pr",{githubToken:loadedConfigs.globals.githubToken,owner:loadedConfigs[selectRepository.value].owner,repo:loadedConfigs[selectRepository.value].repo,head:tbxHeadBranch.value,source:tbxSourceBranch.value,title:tbxPRTitle.value,body:tbxPR.value})}window.zendit.receive("branches-got",(e=>{branchList.innerHTML="",e.branches.filter((e=>{if(""!=e)return e})).forEach((e=>{branchName=e.split(" ").pop(),branchOption=document.createElement("option"),branchOption.value=branchName,branchOption.innerText=branchName,branchList.appendChild(branchOption)}))})),window.zendit.receive("settings-got",(e=>{if("globals"==e.repo)e.config.alias="Global";else if(e.repo in loadedConfigs==0){const t=document.createElement("option");t.value=e.repo,t.innerText=e.config.alias,selectRepository.appendChild(t)}loadedConfigs[e.repo]=e.config,selectRepository.childNodes.length>0&&populate_branches()}));